{\rtf1\mac\ansicpg10000\uc1\deff4\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\upr{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman{\*\falt Times};}{\f4\fnil\fcharset256\fprq2{\*\panose c4e800000001bfffa2e0}Times{\*\falt Times New Roman};}}{\*\ud{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman{\*\falt Times};}{\f4\fnil\fcharset256\fprq2{\*\panose c4e800000001bfffa2e0}Times{\*\falt Times New Roman};}}}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\ql \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\*\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 Normal Table;}{\*\cs15 \additive \ul\cf2 \sbasedon10 Hyperlink;}}{\*\rsidtbl \rsid2180768\rsid2972099\rsid3950766\rsid4222140\rsid4541189\rsid8463931\rsid9250657\rsid10428783\rsid10443356\rsid16391644}{\info{\title PCA_Toolbox 1}{\author Joseph Dien}{\operator Joseph Dien}{\creatim\yr2005\mo2\dy23\hr22\min17}{\revtim\yr2008\mo1\dy27\hr16\min56}{\version52}{\edmins71}{\nofpages6}{\nofwords1610}{\nofchars9180}{\*\company Tulane University}{\nofcharsws11273}{\vern24977}}\ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\formshade\horzdoc\dgmargin\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3\jcompress\viewkind4\viewscale100\pgbrdrhead\pgbrdrfoot\nolnhtadjtbl\rsidroot4222140 \fet0\sectd \linex0\endnhere\sectdefaultcl\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \qc \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\insrsid2180768 ERP PCA }{\b\insrsid2972099 Toolbox}{\b\insrsid9250657  1.1}{\b\insrsid4222140 \par }\pard \ql \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \par }\pard \ql \fi360\li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 This Matlab toolbox contains my PCA routines for ERP analysis.  This is a port of my previously used programs which were coded in LabVIEW and used SAS to do the actual PCA.  Please feel free to send me suggestions or bug reports at:  jdien@ku.edu.\par \par This package is intended for running }{\insrsid10428783 on a Macintosh using version 7.}{\insrsid4222140 4 of Matlab.  The toolbox has also been used on non-Mac platforms but has not been fully tested so caveat emptor.  On non-Mac platforms you will find a number of files starting with "_" which contain Mac-specific information and can be ignored.  To install, simply add paths to the PCA_Toolbox folder and }{\insrsid2180768 its subfolders}{\insrsid4222140 .  You will also need the EGIS_Toolbox installed (included, courtesy of EGI) if you wish to input or output EGIS format files.  You will also need Scott Makeig\rquote s excellent eeglab toolbox (}{\field{\*\fldinst {\insrsid4222140  HYPERLINK "http://sccn.ucsd.edu/~scott/ica.html" }{\insrsid4541189 {\*\datafield 00d0c9ea79f9bace118c8200aa004ba90b02000000170000002500000068007400740070003a002f002f007300630063006e002e0075006300730064002e006500640075002f007e00730063006f00740074002f006900630061002e00680074006d006c000000e0c9ea79f9bace118c8200aa004ba90b4a00000068007400740070003a002f002f007300630063006e002e0075006300730064002e006500640075002f007e00730063006f00740074002f006900630061002e00680074006d006c000000000000000000000000000000000000000000}}}{\fldrslt {\cs15\ul\cf2\insrsid4222140 http://sccn.ucsd.edu/~scott/ica.html}}}{\insrsid4222140 ) if you wish to run the InfoMax rotation (ICA).\par }\pard \ql \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \par }{\ul\insrsid4222140 Functions\par }\pard \ql \li0\ri0\sl360\slmult1\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 doPCA.m\tab runs the PCA analysis.\par {\*\bkmkstart OLE_LINK1}{\*\bkmkstart OLE_LINK2}PCAtoEGISscript{\*\bkmkend OLE_LINK1}{\*\bkmkend OLE_LINK2}.m\tab example script for setting up parameters for PCAtoEGIS.\par PCAtoEGIS.m\tab exports PCA results to an EGIS ave file for plotting, etc.\par PCAtoANOVA.m\tab exports PCA factor scores in a format suitable for ANOVAs.\par stPCAtoEGISscript.m\tab example script for spatiotemporal PCAtoEGIS procedure.\par doPCAst.m\tab conducts second stage of spatiotemporal PCA procedure.\par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \par Extended instructions are available in the header of each file.  Use the "help" command.  The spatiotemporal and parametric PCA procedures will require more in-depth instructions that will be provided in the future.\par \par Good luck!\par \par Joe\par \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid10428783 {\insrsid10428783 Copyright (C) 1999-2008  Joseph Dien\par \par This program is free software: you can redistribute it and/or modify\par it under the terms of the GNU General Public License as published by\par the Free Software Foundation, either version 3 of the License, or\par (at your option) any later version.\par  \par This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  Programs are not for medical use or any other application where use or misuse could cause injury.  See the GNU General Public License for more details.\par  \par You should have received a copy of the GNU General Public License\par along with this program.  If not, see <http://www.gnu.org/licenses/>.}{\insrsid4222140 \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \par }{\insrsid10443356\charrsid10443356 The data import functionality is based on }{\insrsid10443356 Robert Oostenveld's (}{\insrsid10443356\charrsid10443356 http://oostenveld.net}{\insrsid10443356 ) }{\insrsid10443356\charrsid10443356 FieldTrip-lite-}{\insrsid10443356 20071220}{\insrsid10443356\charrsid10443356  toolbox (http://www.ru.nl/fcdonders/fieldtrip) }{\insrsid2180768 with permission under the GNU license.  They have not been changed except for moving read_data.m, read_header.m, and reader_event.m files were moved outside of the "private" folder.  All contents of the "private" folder are from FieldTrip.}{\insrsid2180768\charrsid2180768 \par \par The files ave_hdr_offsets_v.m}{\insrsid2180768  and }{\insrsid2180768\charrsid2180768 wt_ses_hdr_v2.m are from EGI's EGI Toolbox with permission.  The files rd_PCAegis_hdr_v.m}{\insrsid2180768  and }{\insrsid2180768\charrsid2180768 wt_PCAave_hdr_v.m}{\insrsid2180768  were modified from this same source.}{\insrsid2180768\charrsid2180768 \par }{\insrsid4222140 \par History\par \par }{\ul\insrsid4222140 Changes from 1.0b1\par }{\insrsid4222140 %age of variance accounted for by each Promax rotated factor returned.  Fixed error in Promax algorithm.  Changed output variable names to more readable names.\par Parametric PCA technique now supported by EGIStoPCA routine.\par \par }{\ul\insrsid4222140 Changes from 1.0b2\par }{\insrsid4222140 Kaiser correction now works when it is turned on.\par Factor scores now correctly computed when relationship matrix is covariance or SSCP matrix.  Factor scores are no longer zero-centered when using SSCP matrix.\par Added spatiotemporal PCA procedure.\par PCAtoEGIS now returns peak latencies of factors.\par Various modifications to improve performance or ease of use.\par \par }{\ul\insrsid4222140 Changes from 1.0b3\par }{\insrsid4222140 Changed factor score calculation to avoid need for generalized inversion of relationship matrix, which could cause singularity problems.\par Dropped output of scoring coefficient matrix for the same reason.\par Fixed Promax factor score computation.\par Changed default factor waveform output to pattern matrix for PCAtoEGIS routine.\par \par }{\ul\insrsid4222140 Changes from 1.0b4\par }{\insrsid4222140 Changed factor scores to unstandardized form to correctly handle variables with non-zero means, especially non-average reference data and ST-PCAs.\par Added peakChan and peakSamp output to PCAtoEGIS routine.\par \par }{\ul\insrsid4222140 Changes from 1.0fc1\par }{\insrsid4222140 Fixed readEGISave bugs for outputting spatial formatted data.\par \par }{\ul\insrsid4222140 Changes from 1.0fc2\par }{\insrsid4222140 Fixed readEGISave bugs when parameters not specified.  Fixed PmxUnPat parameter name in PCAtoEGISscript.\par \par }{\ul\insrsid4222140 Changes from 1.0fc3\par }{\insrsid4222140 Abandoned effort to enable non mean-corrected  factor scores as unworkable.  Added option to superimpose grand average on factor output to facilitate interpretation.\par  Dropped UnPat outputs since not needed.  Made PCAtoEGIS scripts easier to use.\par Percentage accounted for fixed.\par \par }{\ul\insrsid4222140 Changes from 1.0\par }{\insrsid4222140 Added error-checking code to PCAtoEGISscript and stPCAtoEGISscript to make sure the subject, channel, timepoint, and cell parameters match up with the size of the matrices.\par \par }{\ul\insrsid4222140 {\*\bkmkstart OLE_LINK3}{\*\bkmkstart OLE_LINK4}Changes from 1.01\par }{\insrsid4222140 Moved eyeblink correction routines to a separate ICAblink_toolbox.  Modified EGIStoPCA {\*\bkmkend OLE_LINK3}{\*\bkmkend OLE_LINK4}routine to optionally output factor waveforms as a matlab cell array.\par \par }{\ul\insrsid4222140 Changes from 1.02\par }{\insrsid4222140 Fixed bug in parametric PCA output. Fixed EGIStoPCA subject specs to include subject ID number so NetStation will label observations properly and NAvg so BESA will have N= info.\par \par }{\ul\insrsid4222140 Changes from 1.03\par }{\insrsid4222140 Fixed bug in PCAtoEGISscript output of reconstructed factor waveforms for spatiotemporal PCA only.  Implemented non-mean corrected factor scores.\par }{\ul\insrsid4222140 \par Changes from 1.04\par }{\insrsid4222140 Generalized output format of doPCA so that rotations can be Varimax instead of Promax.  To use with existing PCAtoEGIS scripts, replace the portion under the dividing line with the new code.  Added variance correction after Varimax rotation to ensure that factor scores remain unitized, resulting in some improvement in solution output.\par \par }{\ul\insrsid4222140 Changes from 1.05\par }{\insrsid4222140 Option for unrotated output added.  Error introduced in 1.04 fixed regarding computation of non-mean centered factor scores fixed.  Added centroid measure to ANOVA output options.  Fix to latency ANOVA output.  Changed missing values number for parametric PCA from zero to "999."  Modified to work under Matlab 6.5.\par \par }{\ul\insrsid4222140 Changes from 1.06\par }{\insrsid4222140 Added }{\cf1\insrsid4222140 readNSmat.  Added InfoMax (ICA) rotation option.  Fixed bug in parametric PCA for cells past the first one.  Automatically change bins to 500 for EGIS format output to avoid losing too much resolution if bins are a small number, such as from NS.  Added saving of scores matrix when doing parametric PCA in order to facilitate parametric analysis.  Added option for separate subject output files by PCAtoEGIS to facilitate individual subject source analyses.  Modified cellist feature in readEGISave so that the cells retain their original cell numbers.}{\insrsid4222140 \par \par }{\ul\insrsid4222140 Changes from 1.07\par }{\insrsid4222140 Added option for covariance loadings.  Updated my contact information to University of Kansas.\par \par }{\ul\insrsid4222140 Changes from 1.08\par }{\insrsid4222140 Modified code to treat covariance loading as an alternate weighting scheme to Kaiser normalization since that's what it is.  Modified covariance loadings so that, like Kaiser normalization, it only affects the weights at the Varimax stage, not at the Promax stage.\par \par }{\ul\insrsid4222140 {\*\bkmkstart OLE_LINK9}Changes from 1.090\par }{\insrsid4222140 Bugs fixed in PCAtoEGIS file.  Legal language in this readme file modified.  Grand average option added to doPCA.  ICA option set to reinitialize random number generator with each use and to use non-verbose output.{\*\bkmkend OLE_LINK9}\par \par }{\ul\insrsid4222140 Changes from 1.092\par }{\insrsid4222140 Bugs fixed in PCAtoANOVA file.  EGI Toolkit included courtesy of EGI.  Added error check to PCAtoEGIS.\par \par }{\ul\insrsid4222140 Changes from 1.093}{\ul\insrsid16391644  (9/3/06)}{\ul\insrsid4222140 \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid16391644 {\insrsid16391644 In parametric PCA procedure, drop cells corresponding to missing data parameters when generating the mean voltage map.}{\insrsid4222140 \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \par }{\ul\insrsid3950766 Changes from 1.094 (11/4/06)\par }\pard \ql \li0\ri0\nowidctlpar\faauto\rin0\lin0\itap0\pararsid3950766 {\insrsid3950766 Fixed unique variance vector (}{\insrsid3950766\charrsid3950766 FacVarQ}{\insrsid3950766 ) for Varimax.  Fixed scree and screeST for Infomax.}{\insrsid2972099 \par \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\ul\insrsid2972099 Changes from 1.095 (12/3/06)\par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid2972099 {\insrsid2972099 Fixed ReadEGISave.  When start and end samples were set to zero, the first sample would remain at zero, resulting in the first sample being random and the remaining samples shifted backwards by one sample and the last one being lost.}{\insrsid9250657 \par \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\ul\insrsid10428783 Changes in 1.1}{\ul\insrsid9250657  (}{\ul\insrsid4541189 1/27/08}{\ul\insrsid9250657 )\par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid10428783 {\insrsid9250657 Bugfix for ICA scree.  }{\insrsid9250657\charrsid9250657 Eliminated indexdata.}{\insrsid9250657   For PCAtoEGISscripts, changed input cell names and parameter names arrays to cell arrays.  Changed cellcoll to cell array, thus eliminating need to pad it out with zeroes.  Deleted old filetype function (only worked on OS 9 Macs).}{\insrsid10428783   Switched to the use of the Field Trip I/O routines for reading in files.  Changed data matrix to 3D array.  Shifted to GNU license.}{\insrsid4541189   Made EGIS files always big-endian so that NetStation will correctly read files made on Intel Macs.}{\insrsid2972099\charrsid9250657 \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid2972099 {\insrsid4222140 \par }\pard \ql \li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0 {\insrsid4222140 \page \par }{\ul\insrsid4222140 Bibliography\par }{\insrsid4222140 \par }\pard \ql \fi-360\li360\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin360\itap0 {\insrsid4222140 Dien, J., Tucker, D. M., Potts, G., & Hartry, A. (1997). Localization of auditory evoked potentials related to selective intermodal attention. }{\i\insrsid4222140 Journal of Cognitive Neuroscience, 9}{\insrsid4222140 (6), 799-823.\par \par Dien, J. (1998). Addressing misallocation of variance in principal components analysis of event-related potentials. }{\i\insrsid4222140 Brain Topography, 11}{\insrsid4222140 (1), 43-55.\par \par Dien, J. (1999). Differential lateralization of trait anxiety and trait fearfulness: evoked potential correlates. }{\i\insrsid4222140 Personality and Individual Differences, 26}{\insrsid4222140 (1), 333-356.\par \par Dien, J., Frishkoff, G. A., & Tucker, D. M. (2000). Differentiating the N3 and N4 electrophysiological semantic incongruity effects. }{\i\insrsid4222140 Brain & Cognition, 43}{\insrsid4222140 , 148-152.\par \par Dien, J., Frishkoff, G., Cerbonne, A., & Tucker, D. M. (2003). Parametric analysis of event-related potentials in semantic comprehension: Evidence for parallel brain mechanisms. }{\i\insrsid4222140 Cognitive Brain Research, 15}{\insrsid4222140 , 137-153.\par \par Dien, J., Spencer, K. M., & Donchin, E. (2003). Localization of the event-related potential novelty response as defined by principal components analysis. }{\i\insrsid4222140 Cognitive Brain Research, 17}{\insrsid4222140 , 637-650.\par \par Dien, J., Spencer, K. M., & Donchin, E. (2004). Parsing the "Late Positive Complex": Mental chronometry and the ERP components that inhabit the neighborhood of the P300. }{\i\insrsid4222140 Psychophysiology, 41}{\insrsid4222140 (5), 665-678.\par \par Dien, J., & Frishkoff, G. A. (2004). Principal components analysis of event-related potential datasets. In T. Handy (Ed.), }{\i\insrsid4222140 Event-Related Potentials: A Methods Handbook}{\insrsid4222140 . Cambridge, Mass: MIT Press.\par \par Dien, J., Beal, D. J., & Berg, P. (2005). Optimizing principal components analysis of event-related potential analysis: Matrix type, factor loading weighting, extraction, and rotations. }{\i\insrsid4222140 Clinical Neurophysiology, 116}{\insrsid4222140 (8), 1808-1825.}{\insrsid3950766 \par \par }{\insrsid10428783\charrsid10428783 Dien, J., Khoe, W., and Mangun, G. R. (2007). Evaluation of PCA and ICA of simulated ERPs: Promax versus Infomax rotations. Human Brain Mapping, 28(8):742-63.}{\insrsid4222140\charrsid10428783 \par }{\insrsid4222140 \par Donchin, E., & Heffley, E. (1979). Multivariate analysis of event-related potential data: A tutorial review. In D. Otto (Ed.), }{\i\insrsid4222140 Multidisciplinary perspectives in event-related potential research (EPA 600/9-77-043)}{\insrsid4222140  (pp. 555-572). Washington, DC: U.S. Government Printing Office.\par \par }{\insrsid10428783\charrsid10428783 O'Hare, A. J., Dien, J., Waterson, L., Savage, C. R. (in press). Activation of the Posterior Cingulate by Semantic Priming: A co-registered ERP/fMRI Study.}{\insrsid10428783 \par }{\insrsid10428783\charrsid10428783 \par }{\insrsid4222140 Spencer, K. M., Dien, J., & Donchin, M. (1999). A componential analysis of the ERP elicited by novel events using a dense electrode array. }{\i\insrsid4222140 Psychophysiology, 36}{\insrsid4222140 , 409-414.\par \par Spencer, K. M., Dien, J., & Donchin, E. (2001). Spatiotemporal Analysis of the Late ERP Responses to Deviant Stimuli. }{\i\insrsid4222140 Psychophysiology, 38}{\insrsid4222140 (2), 343-358.\par }}