{\rtf1\mac\ansicpg10000\uc1\deff4\stshfdbch0\stshfloch0\stshfhich0\stshfbi0\deflang1033\deflangfe1033{\upr{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman{\*\falt Times};}{\f4\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Times{\*\falt Times New Roman};}}{\*\ud{\fonttbl{\f0\fnil\fcharset256\fprq2{\*\panose 00020206030504050203}Times New Roman{\*\falt Times};}{\f4\fnil\fcharset256\fprq2{\*\panose 00020005000000000000}Times{\*\falt Times New Roman};}}}}{\colortbl;\red0\green0\blue0;\red0\green0\blue255;\red0\green255\blue255;\red0\green255\blue0;\red255\green0\blue255;\red255\green0\blue0;\red255\green255\blue0;\red255\green255\blue255;\red0\green0\blue128;\red0\green128\blue128;\red0\green128\blue0;\red128\green0\blue128;\red128\green0\blue0;\red128\green128\blue0;\red128\green128\blue128;\red192\green192\blue192;}{\stylesheet{\ql \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 \snext0 Normal;}{\*\cs10 \additive Default Paragraph Font;}{\*\ts11\tsrowd\trftsWidthB3\trpaddl108\trpaddr108\trpaddfl3\trpaddft3\trpaddfb3\trpaddfr3\tscellwidthfts0\tsvertalt\tsbrdrt\tsbrdrl\tsbrdrb\tsbrdrr\tsbrdrdgl\tsbrdrdgr\tsbrdrh\tsbrdrv \ql \li0\ri0\widctlpar\aspalpha\aspnum\faauto\adjustright\rin0\lin0\itap0 \fs20\lang1024\langfe1024\cgrid\langnp1024\langfenp1024 \snext11 Normal Table;}{\*\cs15 \additive \ul\cf2 \sbasedon10 Hyperlink;}}{\*\rsidtbl \rsid2972099\rsid3950766\rsid4222140\rsid4943015\rsid7109963\rsid8463931\rsid9250657\rsid9663971\rsid10428783\rsid12979042\rsid13707788\rsid14712346\rsid16391644}{\info{\title PCA_Toolbox 1}{\author Joseph Dien}{\operator Joseph Dien}{\creatim\yr2007\mo12\dy20\hr19\min1}{\revtim\yr2008\mo1\dy14\hr17\min14}{\version22}{\edmins41}{\nofpages3}{\nofwords740}{\nofchars4218}{\*\company Tulane University}{\nofcharsws5180}{\vern24977}}\ftnbj\aenddoc\noxlattoyen\expshrtn\noultrlspc\dntblnsbdb\nospaceforul\hyphcaps0\formshade\horzdoc\dgmargin\dghspace120\dgvspace120\dghorigin1701\dgvorigin1984\dghshow0\dgvshow3\jcompress\viewkind4\viewscale100\pgbrdrhead\pgbrdrfoot\nolnhtadjtbl\rsidroot4222140 \fet0\sectd \linex0\endnhere\sectdefaultcl\sftnbj {\*\pnseclvl1\pnucrm\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl2\pnucltr\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl3\pndec\pnstart1\pnindent720\pnhang{\pntxta .}}{\*\pnseclvl4\pnlcltr\pnstart1\pnindent720\pnhang{\pntxta )}}{\*\pnseclvl5\pndec\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl6\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl7\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl8\pnlcltr\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}{\*\pnseclvl9\pnlcrm\pnstart1\pnindent720\pnhang{\pntxtb (}{\pntxta )}}\pard\plain \qc \li0\ri0\widctlpar\faauto\adjustright\rin0\lin0\itap0 \f4\lang1033\langfe1033\cgrid\langnp1033\langfenp1033 {\b\insrsid13707788 ERP }{\b\insrsid2972099 PCA}{\b\insrsid13707788  }{\b\insrsid2972099 Toolbox}{\b\insrsid9250657  1.1}{\b\insrsid4222140 \par }\pard \ql \fi-360\li360\ri0\widctlpar\faauto\adjustright\rin0\lin360\itap0\pararsid13707788 {\insrsid4222140 \par }\pard \ql \fi360\li0\ri0\widctlpar\tx2160\faauto\adjustright\rin0\lin0\itap0\pararsid13707788 {\insrsid13707788 The following is just meant to be a very brief example of how to use this toolbox and is not meant to cover all the many possible variations.}{\insrsid13707788\charrsid13707788   You will first have to decide whether to run a spatial, temporal, or two-step PCA.  I usually recommend a temporo-spatial PCA and this tutorial will follow this suggested procedure.}{\insrsid13707788 \par \par 1) Install the Toolbox.\par \par Put this toolbox into the desired directory and add it to the Matlab path using the "Set Path..." command under the File menu.  Use the "Add with Subfolders" button.\par \par 2) Import data into Matlab.\par \par Set the current directory of Matlab to the directory with the data file.  Use the Field Trip functions to import the data.  For an EGI EGIS file, the command might be:\par \par }{\insrsid13707788\charrsid13707788 [data]=read_data('NT9coll.ave_af.egis','dataformat','egi_egia');\par \par where "NT9coll.ave_af.egis" is the file name.  It needs to have an appropriate suffix in order for it to be recognized properly.  For other types of files, see the contents of read_event.m in the }{\insrsid4943015\charrsid13707788 FieldTrip folder in the }{\insrsid13707788\charrsid13707788 subroutines folder t}{\insrsid12979042\charrsid13707788 o see what the appropriate data}{\insrsid13707788\charrsid13707788 format }{\insrsid12979042\charrsid13707788 value would be.  You will also need to find out what the acceptable file suffixes are from the filetype.m file in the private folder in the FieldTrip folder}{\insrsid13707788\charrsid13707788 .  Unfortunately, documentation is not available for this Field Trip function but it seems to cover all the major EEG file types.  Make sure to include the semi-colon at the end of the command or Matlab will attempt to list the entire contents of the data file on the screen!\par \par 3) Run the first PCA.\par \par Next run the initial PCA.  See the documentation in the doPCA.m file for more information about the options and how they work.  The first step is to determine the number of factors to retain.  I recommend using Promax rotation and a covariance matrix:\par \par [FacPat, FacStr, FacScr, FacRef, FacCor, scree, facVar, facVarQ, varSD] = doPCA('temp', 'PMAX', 'COV', 1, data, 'K');\par \par Use a method like the Scree Test (using the contents of the Scree variable) to determine how many factors to retain and then run the PCA again, in this case with ten factors retained.\par \par [FacPat, FacStr, FacScr, FacRef, FacCor, scree, facVar, facVarQ, varSD] = doPCA('temp', 'PMAX', 'COV', 10, data, 'K');\par \par Note the amount of variance accounted for, as it will be needed for the results section:\par \par Amount of variance (communality) accounted for by Promax solution is 75.7892%.}{\insrsid13707788 \par \par }{\insrsid13707788\charrsid13707788 4) Run the second PCA.\par \par Next you need to know how many factors to retain for the second step PCAs.  To keep things simple, the same number is retained for all the second step (justified on the basis of studies suggesting that overextracting by a small amount is normally not a problem).\par \par [FacPatST, FacStrST, FacScrST, FacRefST, FacCorST, screeST, facVarST, facVarQST, varSDST] = doPCAst('IMAX', 'COV', 1, FacScr, 'K', facVar, facVarQ, FacPat, varSD, 129);\par \par Use a method like the Scree Test (using the contents of the ScreeST variable, which contains the scree test for each of the separate PCAs conducted on the first round factors).  Then run it again.\par \par [FacPatST, FacStrST, FacScrST, FacRefST, FacCorST, screeST, facVarST, facVarQST, varSDST] = doPCAst('IMAX', 'COV', 5, FacScr, 'K', facVar, facVarQ, FacPat, varSD, 129);\par \par 5) Generate the factor waveforms and the factor score ANOVA files.\par \par Use either }{\insrsid13707788 PCAtoEGISscript.m or stPCAtoEGISscript.m depending on whether it was a one-step or two-step PCA.  Since it is a script, it will need to be customized for your analysis.  Save a renamed copy in your data directory and then modify it.  You will need to specify how many output cells there are and what input cells go into those output cells.  So, for example, you could generate interpretable combinations of the cells by collapsing over some of the cell types.  The scripts are annotated as to what types of information is needed.  Once it is ready, run it by just typing its name in the Matlab command window.  It will generate an EGIS file with the factor waveforms (or you can set it to output a Matlab matrix named facWaves).  It will also save the contents of the Matlab workspace in case you want to return to the analysis at a later point.  Finally, it will generate a set of files suitable for ANOVAs, one for each factor.\par \par 6) Examine the results.\par \par If you are using EGIS files and need to read them using NetStation, you will need to use a utility like }{\insrsid9663971 Quick Change}{\insrsid13707788  (free}{\insrsid7109963  download from a site like Vers}{\insrsid13707788 ionTracker.com) and use it to change the file type to "EGIA" and the Creator to "NETs" without the quotation marks.\par \par The first set of factors in this example would be the five spatial factors that were generated from the first temporal factor (and will therefore all have the same time course but different scalp topographies).  The next set of five factors would be from the second temporal factor and so forth.  The final "factor" is actually the summation of all the factors to help you see how well they account for the original grand average waveform.  Missing features were discarded during the factor retention step.  A new cell, "all", was also added to show what the average of all the cells would look like.}{\insrsid4222140\charrsid13707788 \par }}